<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>fal.toolkit.utils package &#8212; fal_sdk  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="fal.toolkit.video package" href="fal.toolkit.video.html" />
    <link rel="prev" title="fal.toolkit.image.nsfw_filter package" href="fal.toolkit.image.nsfw_filter.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="fal-toolkit-utils-package">
<h1>fal.toolkit.utils package<a class="headerlink" href="#fal-toolkit-utils-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-fal.toolkit.utils.download_utils">
<span id="fal-toolkit-utils-download-utils-module"></span><h2>fal.toolkit.utils.download_utils module<a class="headerlink" href="#module-fal.toolkit.utils.download_utils" title="Link to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="fal.toolkit.utils.download_utils.DownloadError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.download_utils.</span></span><span class="sig-name descname"><span class="pre">DownloadError</span></span><a class="headerlink" href="#fal.toolkit.utils.download_utils.DownloadError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fal.toolkit.utils.download_utils.clone_repository">
<span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.download_utils.</span></span><span class="sig-name descname"><span class="pre">clone_repository</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">https_url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">commit_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repo_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_to_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fal.toolkit.utils.download_utils.clone_repository" title="Link to this definition">¶</a></dt>
<dd><p>Clones a Git repository from the specified HTTPS URL into a local
directory.</p>
<p>This function clones a Git repository from the specified HTTPS URL into a local
directory. It can also checkout a specific commit if the <cite>commit_hash</cite> is provided.</p>
<p>If a custom <cite>target_dir</cite> or <cite>repo_name</cite> is not specified, a predefined directory is
used for the target directory, and the repository name is determined from the URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>https_url</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The HTTPS URL of the Git repository to be cloned.</p></li>
<li><p><strong>commit_hash</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The commit hash to checkout after cloning.</p></li>
<li><p><strong>target_dir</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The directory where the repository will be saved.
If not provided, a predefined directory is used.</p></li>
<li><p><strong>repo_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – The name to be used for the cloned repository directory.
If not provided, the repository’s name from the URL is used.</p></li>
<li><p><strong>force</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If <cite>True</cite>, the repository is cloned even if it already exists locally
and its commit hash matches the provided commit hash. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>include_to_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If <cite>True</cite>, the cloned repository is added to the <cite>sys.path</cite>.
Defaults to <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Path object representing the full path to the cloned Git repository.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fal.toolkit.utils.download_utils.download_file">
<span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.download_utils.</span></span><span class="sig-name descname"><span class="pre">download_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filesize_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fal.toolkit.utils.download_utils.download_file" title="Link to this definition">¶</a></dt>
<dd><p>Downloads a file from the specified URL to the target directory.</p>
<p>The function downloads the file from the given URL and saves it in the specified
target directory, provided it is below the given filesize limit.</p>
<p>It also checks whether the local file already exists and whether its content length
matches the expected content length from the remote file. If the local file already
exists and its content length matches the expected content length from the remote
file, the existing file is returned without re-downloading it.</p>
<p>If the file needs to be downloaded or if an existing file’s content length does not
match the expected length, the function proceeds to download and save the file. It
ensures that the target directory exists and handles any errors that may occur
during the download process, raising a <cite>DownloadError</cite> if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The URL of the file to be downloaded.</p></li>
<li><p><strong>target_dir</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span>) – The directory where the downloaded file will be saved. If it’s not
an absolute path, it’s treated as a relative directory to “/data”.</p></li>
<li><p><strong>force</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If <cite>True</cite>, the file is downloaded even if it already exists locally and
its content length matches the expected content length from the remote file.
Defaults to <cite>False</cite>.</p></li>
<li><p><strong>request_headers</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>] | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – A dictionary containing additional headers to be included in
the HTTP request. Defaults to <cite>None</cite>.</p></li>
<li><p><strong>filesize_limit</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – An integer specifying the maximum downloadable size,
in megabytes. Defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Path object representing the full path to the downloaded file.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the provided <cite>file_name</cite> contains a forward slash (‘/’).</p></li>
<li><p><a class="reference internal" href="#fal.toolkit.utils.download_utils.DownloadError" title="fal.toolkit.utils.download_utils.DownloadError"><strong>DownloadError</strong></a> – If an error occurs during the download process.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fal.toolkit.utils.download_utils.download_model_weights">
<span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.download_utils.</span></span><span class="sig-name descname"><span class="pre">download_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fal.toolkit.utils.download_utils.download_model_weights" title="Link to this definition">¶</a></dt>
<dd><p>Downloads model weights from the specified URL and saves them to a
predefined directory.</p>
<p>This function is specifically designed for downloading model weights and stores
them in a predefined directory.</p>
<p>It calls the <cite>download_file</cite> function with the provided
URL and the target directory set to a pre-defined location for model weights.
The downloaded model weights are saved in this directory, and the function returns
the full path to the downloaded weights file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The URL from which the model weights will be downloaded.</p></li>
<li><p><strong>force</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If <cite>True</cite>, the model weights are downloaded even if they already exist
locally and their content length matches the expected content length from
the remote file. Defaults to <cite>False</cite>.</p></li>
<li><p><strong>request_headers</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>] | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – A dictionary containing additional headers to be included in
the HTTP request. Defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Path object representing the full path to the downloaded model weights.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fal.toolkit.utils.endpoint">
<span id="fal-toolkit-utils-endpoint-module"></span><h2>fal.toolkit.utils.endpoint module<a class="headerlink" href="#module-fal.toolkit.utils.endpoint" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fal.toolkit.utils.endpoint.cancel_on_disconnect">
<span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.endpoint.</span></span><span class="sig-name descname"><span class="pre">cancel_on_disconnect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fal.toolkit.utils.endpoint.cancel_on_disconnect" title="Link to this definition">¶</a></dt>
<dd><p>Async context manager for async code that needs to be cancelled if client
disconnects prematurely.
The client disconnect is monitored through the Request object.</p>
</dd></dl>

</section>
<section id="module-fal.toolkit.utils.retry">
<span id="fal-toolkit-utils-retry-module"></span><h2>fal.toolkit.utils.retry module<a class="headerlink" href="#module-fal.toolkit.utils.retry" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fal.toolkit.utils.retry.retry">
<span class="sig-prename descclassname"><span class="pre">fal.toolkit.utils.retry.</span></span><span class="sig-name descname"><span class="pre">retry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exponential'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fal.toolkit.utils.retry.retry" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fal.toolkit.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fal.toolkit.utils" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">fal_sdk</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">fal</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="fal.html">fal package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">fal</a><ul>
  <li><a href="fal.html">fal package</a><ul>
  <li><a href="fal.toolkit.html">fal.toolkit package</a><ul>
      <li>Previous: <a href="fal.toolkit.image.nsfw_filter.html" title="previous chapter">fal.toolkit.image.nsfw_filter package</a></li>
      <li>Next: <a href="fal.toolkit.video.html" title="next chapter">fal.toolkit.video package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, FAL Team.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/fal.toolkit.utils.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>